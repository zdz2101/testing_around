<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Add a variable flagging the first or last observation within each by group"><title>Add a Variable Flagging the First or Last Observation Within Each By Group — derive_var_extreme_flag • admiral</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add a Variable Flagging the First or Last Observation Within Each By Group — derive_var_extreme_flag"><meta property="og:description" content="Add a variable flagging the first or last observation within each by group"><meta property="og:image" content="https://pharmaverse.github.io/admiral/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/admiral.html">Get Started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-user-guides">User Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-user-guides">
    <a class="dropdown-item" href="../articles/admiral.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Deep Dives on ADaMs</h6>
    <a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a>
    <a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a>
    <a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a>
    <a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a>
    <a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a>
    <a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a>
    <h6 class="dropdown-header" data-toc-skip>Advanced User Guides</h6>
    <a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a>
    <a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a>
    <a class="dropdown-item" href="../articles/generic.html">Generic Functions</a>
    <a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a>
    <a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a>
    <a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a>
    <a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-community">Community</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-community">
    <a class="dropdown-item" href="../articles/contribution_model.html">Contribute to admiral</a>
    <a class="external-link dropdown-item" href="https://app.slack.com/client/T028PB489D3/C02M8KN8269">Find us on Slack</a>
    <a class="external-link dropdown-item" href="https://pharmaverse.org/">Welcome to the Pharmaverse</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add a Variable Flagging the First or Last Observation Within Each By Group</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/R/derive_var_extreme_flag.R" class="external-link"><code>R/derive_var_extreme_flag.R</code></a></small>
      <div class="d-none name"><code>derive_var_extreme_flag.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add a variable flagging the first or last observation within each by group</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_var_extreme_flag</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">by_vars</span>,</span>
<span>  <span class="va">order</span>,</span>
<span>  <span class="va">new_var</span>,</span>
<span>  <span class="va">mode</span>,</span>
<span>  flag_all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_type <span class="op">=</span> <span class="st">"warning"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dataset</dt>
<dd><p>Input dataset</p>
<p>The variables specified by the <code>by_vars</code> parameter are expected.</p></dd>


<dt>by_vars</dt>
<dd><p>Grouping variables</p>
<p>Permitted Values: list of variables</p></dd>


<dt>order</dt>
<dd><p>Sort order</p>
<p>The first or last observation is determined with respect to the specified
order.</p>
<p>Permitted Values: list of variables or functions of variables</p></dd>


<dt>new_var</dt>
<dd><p>Variable to add</p>
<p>The specified variable is added to the output dataset. It is set to <code>"Y"</code>
for the first or last observation (depending on the mode) of each by group.</p>
<p>Permitted Values: list of name-value pairs</p></dd>


<dt>mode</dt>
<dd><p>Flag mode</p>
<p>Determines of the first or last observation is flagged.</p>
<p>Permitted Values: <code>"first"</code>, <code>"last"</code></p></dd>


<dt>flag_all</dt>
<dd><p>Flag setting</p>
<p>A logical value where if set to <code>TRUE</code>, all records are flagged
and no error or warning is issued if the first or last record is not unique.</p></dd>


<dt>check_type</dt>
<dd><p>Check uniqueness?</p>
<p>If <code>"warning"</code> or <code>"error"</code> is specified, the specified message is issued
if the observations of the input dataset are not unique with respect to the
by variables and the order.</p>
<p>Default: <code>"warning"</code></p>
<p>Permitted Values: <code>"none"</code>, <code>"warning"</code>, <code>"error"</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The input dataset with the new flag variable added</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each group (with respect to the variables specified for the
<code>by_vars</code> parameter), <code>new_var</code> is set to <code>"Y"</code> for the first or last observation
(with respect to the order specified for the <code>order</code> parameter and the flag mode
specified for the <code>mode</code> parameter). In the case where the user wants to flag multiple records
of a grouping, for example records that all happen on the same visit and time, the argument
<code>flag_all</code> can be set to <code>TRUE</code>.
Otherwise, <code>new_var</code> is set to <code>NA</code>. Thus, the direction of "worst" is considered fixed for
all parameters in the dataset depending on the <code>order</code> and the <code>mode</code>, i.e. for every
parameter the first or last record will be flagged across the whole dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>General Derivation Functions for all ADaMs that returns variable appended to dataset:
<code><a href="derive_var_joined_exist_flag.html">derive_var_joined_exist_flag</a>()</code>,
<code><a href="derive_var_merged_exist_flag.html">derive_var_merged_exist_flag</a>()</code>,
<code><a href="derive_var_merged_summary.html">derive_var_merged_summary</a>()</code>,
<code><a href="derive_var_obs_number.html">derive_var_obs_number</a>()</code>,
<code><a href="derive_var_relative_flag.html">derive_var_relative_flag</a>()</code>,
<code><a href="derive_vars_joined.html">derive_vars_joined</a>()</code>,
<code><a href="derive_vars_merged_lookup.html">derive_vars_merged_lookup</a>()</code>,
<code><a href="derive_vars_merged.html">derive_vars_merged</a>()</code>,
<code><a href="derive_vars_transposed.html">derive_vars_transposed</a>()</code>,
<code><a href="get_summary_records.html">get_summary_records</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">example_vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VSTESTCD</span>,      <span class="op">~</span><span class="va">VISIT</span>, <span class="op">~</span><span class="va">VISITNUM</span>, <span class="op">~</span><span class="va">VSTPTNUM</span>, <span class="op">~</span><span class="va">VSSTRESN</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>, <span class="st">"SCREENING"</span>,         <span class="fl">1</span>,        <span class="fl">10</span>,        <span class="fl">64</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>, <span class="st">"SCREENING"</span>,         <span class="fl">1</span>,        <span class="fl">11</span>,        <span class="fl">66</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,  <span class="st">"BASELINE"</span>,         <span class="fl">2</span>,       <span class="fl">100</span>,        <span class="fl">68</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,  <span class="st">"BASELINE"</span>,         <span class="fl">2</span>,       <span class="fl">101</span>,        <span class="fl">68</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,    <span class="st">"WEEK 2"</span>,         <span class="fl">3</span>,       <span class="fl">200</span>,        <span class="fl">72</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,    <span class="st">"WEEK 2"</span>,         <span class="fl">3</span>,       <span class="fl">201</span>,        <span class="fl">71</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,    <span class="st">"WEEK 4"</span>,         <span class="fl">4</span>,       <span class="fl">300</span>,        <span class="fl">70</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,    <span class="st">"WEEK 4"</span>,         <span class="fl">4</span>,       <span class="fl">301</span>,        <span class="fl">70</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Flag last value for each patient, test, and visit, baseline observations are ignored</span></span></span>
<span class="r-in"><span><span class="va">example_vs</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>    args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">VSTESTCD</span>, <span class="va">VISIT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">VSTPTNUM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      new_var <span class="op">=</span> <span class="va">LASTFL</span>,</span></span>
<span class="r-in"><span>      mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    filter <span class="op">=</span> <span class="va">VISIT</span> <span class="op">!=</span> <span class="st">"BASELINE"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">VSTESTCD</span>, <span class="va">VISITNUM</span>, <span class="va">VSTPTNUM</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">VSTESTCD</span>, <span class="va">VISIT</span>, <span class="va">VSTPTNUM</span>, <span class="va">VSSTRESN</span>, <span class="va">LASTFL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID VSTESTCD VISIT     VSTPTNUM VSSTRESN LASTFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1001    DIABP    SCREENING       10       64 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1001    DIABP    SCREENING       11       66 Y     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1001    DIABP    BASELINE       100       68 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1001    DIABP    BASELINE       101       68 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1001    DIABP    WEEK 2         200       72 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1001    DIABP    WEEK 2         201       71 Y     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 1001    DIABP    WEEK 4         300       70 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> 1001    DIABP    WEEK 4         301       70 Y     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Baseline (ABLFL) examples:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">STUDYID</span>, <span class="op">~</span><span class="va">USUBJID</span>,  <span class="op">~</span><span class="va">PARAMCD</span>,     <span class="op">~</span><span class="va">AVISIT</span>,                  <span class="op">~</span><span class="va">ADT</span>, <span class="op">~</span><span class="va">AVAL</span>,    <span class="op">~</span><span class="va">DTYPE</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">15.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-25"</span><span class="op">)</span>,  <span class="fl">14.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-23"</span><span class="op">)</span>,  <span class="fl">15.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,    <span class="st">"WEEK 1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">10.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,    <span class="st">"WEEK 2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-30"</span><span class="op">)</span>,  <span class="fl">12.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">15.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-25"</span><span class="op">)</span>,  <span class="fl">14.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-23"</span><span class="op">)</span>,  <span class="fl">15.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>,    <span class="st">"WEEK 1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">10.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>,    <span class="st">"WEEK 2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-30"</span><span class="op">)</span>,  <span class="fl">12.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">15.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-25"</span><span class="op">)</span>,  <span class="fl">14.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-23"</span><span class="op">)</span>,  <span class="fl">15.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">10.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>,    <span class="st">"WEEK 2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-30"</span><span class="op">)</span>,  <span class="fl">12.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">15.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-25"</span><span class="op">)</span>,  <span class="fl">14.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>,    <span class="st">"WEEK 1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-23"</span><span class="op">)</span>,  <span class="fl">15.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>,    <span class="st">"WEEK 1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">10.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-30"</span><span class="op">)</span>,  <span class="fl">12.0</span>,        <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Last observation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">input</span>,</span></span>
<span class="r-in"><span>  derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">ADT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  filter <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID USUBJID PARAMCD AVISIT    ADT         AVAL DTYPE   ABLFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-27    15 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> TEST01  PAT01   PARAM02 BASELINE  2021-04-27    10 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-25    14 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-30    12 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TEST01  PAT01   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TEST01  PAT01   PARAM01 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> TEST01  PAT02   PARAM01 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> TEST01  PAT02   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> TEST01  PAT02   PARAM01 WEEK 2    2021-04-30    12 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> TEST01  PAT01   PARAM02 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> TEST01  PAT02   PARAM02 SCREENING 2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-27    10 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Worst observation - Direction = High</span></span></span>
<span class="r-in"><span><span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">input</span>,</span></span>
<span class="r-in"><span>  derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AVAL</span>, <span class="va">ADT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  filter <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID USUBJID PARAMCD AVISIT    ADT         AVAL DTYPE   ABLFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-27    15 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> TEST01  PAT01   PARAM02 BASELINE  2021-04-27    10 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-23    15 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TEST01  PAT01   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TEST01  PAT01   PARAM01 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> TEST01  PAT02   PARAM01 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> TEST01  PAT02   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> TEST01  PAT02   PARAM01 WEEK 2    2021-04-30    12 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> TEST01  PAT01   PARAM02 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> TEST01  PAT02   PARAM02 SCREENING 2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-27    10 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Worst observation - Direction = Lo</span></span></span>
<span class="r-in"><span><span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">input</span>,</span></span>
<span class="r-in"><span>  derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="fu"><a href="reexport-desc.html">desc</a></span><span class="op">(</span><span class="va">AVAL</span><span class="op">)</span>, <span class="va">ADT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  filter <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID USUBJID PARAMCD AVISIT    ADT         AVAL DTYPE   ABLFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> TEST01  PAT01   PARAM02 BASELINE  2021-04-27    10 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-25    14 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-30    12 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TEST01  PAT01   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TEST01  PAT01   PARAM01 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> TEST01  PAT02   PARAM01 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> TEST01  PAT02   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> TEST01  PAT02   PARAM01 WEEK 2    2021-04-30    12 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> TEST01  PAT01   PARAM02 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> TEST01  PAT02   PARAM02 SCREENING 2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-27    10 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Average observation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">input</span>,</span></span>
<span class="r-in"><span>  derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">ADT</span>, <span class="fu"><a href="reexport-desc.html">desc</a></span><span class="op">(</span><span class="va">AVAL</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  filter <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span> <span class="op">&amp;</span> <span class="va">DTYPE</span> <span class="op">==</span> <span class="st">"AVERAGE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID USUBJID PARAMCD AVISIT    ADT         AVAL DTYPE   ABLFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-23    15 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> TEST01  PAT01   PARAM02 BASELINE  2021-04-27    10 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-25    14 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TEST01  PAT01   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TEST01  PAT01   PARAM01 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TEST01  PAT02   PARAM01 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TEST01  PAT02   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> TEST01  PAT02   PARAM01 WEEK 2    2021-04-30    12 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> TEST01  PAT01   PARAM02 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> TEST01  PAT02   PARAM02 SCREENING 2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-27    10 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># OCCURDS Examples</span></span></span>
<span class="r-in"><span><span class="va">example_ae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>,         <span class="op">~</span><span class="va">AEBODSYS</span>,    <span class="op">~</span><span class="va">AEDECOD</span>,   <span class="op">~</span><span class="va">AESEV</span>, <span class="op">~</span><span class="va">AESTDY</span>, <span class="op">~</span><span class="va">AESEQ</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1015"</span>, <span class="st">"GENERAL DISORDERS"</span>,  <span class="st">"ERYTHEMA"</span>,   <span class="st">"MILD"</span>,       <span class="fl">2</span>,      <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1015"</span>, <span class="st">"GENERAL DISORDERS"</span>,  <span class="st">"PRURITUS"</span>,   <span class="st">"MILD"</span>,       <span class="fl">2</span>,      <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1015"</span>,      <span class="st">"GI DISORDERS"</span>, <span class="st">"DIARRHOEA"</span>,   <span class="st">"MILD"</span>,       <span class="fl">8</span>,      <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1023"</span>, <span class="st">"CARDIAC DISORDERS"</span>,  <span class="st">"AV BLOCK"</span>,   <span class="st">"MILD"</span>,      <span class="fl">22</span>,      <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1023"</span>,    <span class="st">"SKIN DISORDERS"</span>,  <span class="st">"ERYTHEMA"</span>,   <span class="st">"MILD"</span>,       <span class="fl">3</span>,      <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1023"</span>,    <span class="st">"SKIN DISORDERS"</span>,  <span class="st">"ERYTHEMA"</span>, <span class="st">"SEVERE"</span>,       <span class="fl">5</span>,      <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1023"</span>,    <span class="st">"SKIN DISORDERS"</span>,  <span class="st">"ERYTHEMA"</span>,   <span class="st">"MILD"</span>,       <span class="fl">8</span>,      <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most severe AE first occurrence per patient</span></span></span>
<span class="r-in"><span><span class="va">example_ae</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    TEMP_AESEVN <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AESEV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEVERE"</span>, <span class="st">"MODERATE"</span>, <span class="st">"MILD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">derive_var_extreme_flag</span><span class="op">(</span></span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">AOCCIFL</span>,</span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">TEMP_AESEVN</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"first"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AEDECOD</span>, <span class="va">AESEV</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span>, <span class="va">AOCCIFL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID AEDECOD   AESEV  AESTDY AESEQ AOCCIFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1015    ERYTHEMA  MILD        2     1 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1015    PRURITUS  MILD        2     2 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1015    DIARRHOEA MILD        8     3 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1023    ERYTHEMA  MILD        3     1 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1023    ERYTHEMA  SEVERE      5     2 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1023    ERYTHEMA  MILD        8     3 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 1023    AV BLOCK  MILD       22     4 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most severe AE first occurrence per patient (flag all cases)</span></span></span>
<span class="r-in"><span><span class="va">example_ae</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    TEMP_AESEVN <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AESEV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEVERE"</span>, <span class="st">"MODERATE"</span>, <span class="st">"MILD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">derive_var_extreme_flag</span><span class="op">(</span></span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">AOCCIFL</span>,</span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">TEMP_AESEVN</span>, <span class="va">AESTDY</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"first"</span>,</span></span>
<span class="r-in"><span>    flag_all <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AESTDY</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AEDECOD</span>, <span class="va">AESEV</span>, <span class="va">AESTDY</span>, <span class="va">AOCCIFL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID AEDECOD   AESEV  AESTDY AOCCIFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1015    ERYTHEMA  MILD        2 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1015    PRURITUS  MILD        2 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1015    DIARRHOEA MILD        8 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1023    ERYTHEMA  MILD        3 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1023    ERYTHEMA  SEVERE      5 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1023    ERYTHEMA  MILD        8 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 1023    AV BLOCK  MILD       22 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most severe AE first occurrence per patient per body system</span></span></span>
<span class="r-in"><span><span class="va">example_ae</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    TEMP_AESEVN <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AESEV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEVERE"</span>, <span class="st">"MODERATE"</span>, <span class="st">"MILD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">derive_var_extreme_flag</span><span class="op">(</span></span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">AOCCSIFL</span>,</span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AEBODSYS</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">TEMP_AESEVN</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"first"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AEBODSYS</span>, <span class="va">AESEV</span>, <span class="va">AESTDY</span>, <span class="va">AOCCSIFL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID AEBODSYS          AESEV  AESTDY AOCCSIFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1015    GENERAL DISORDERS MILD        2 Y       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1015    GENERAL DISORDERS MILD        2 <span style="color: #BB0000;">NA</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1015    GI DISORDERS      MILD        8 Y       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1023    SKIN DISORDERS    MILD        3 <span style="color: #BB0000;">NA</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1023    SKIN DISORDERS    SEVERE      5 Y       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1023    SKIN DISORDERS    MILD        8 <span style="color: #BB0000;">NA</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 1023    CARDIAC DISORDERS MILD       22 Y       </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ben Straub, Stefan Bundfuss, Jeffrey Dickinson, Ross Farrugia, Adam Forys, Daphne Grasselly, Dinakar Kulkarni, Edoardo Mancini, Sadchla Mascary, Gordon Miller, Sophie Shapcott, Eric Simms, Stefan Thoma, Kangjie Zhang, Zelos Zhu, G Gayatri, Thomas Neitmann, F. Hoffmann-La Roche AG, GlaxoSmithKline LLC.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

