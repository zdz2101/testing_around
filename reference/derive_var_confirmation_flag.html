<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
This function is deprecated, please use derive_var_joined_exist_flag() instead."><title>Derive Confirmation Flag — derive_var_confirmation_flag • admiral</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derive Confirmation Flag — derive_var_confirmation_flag"><meta property="og:description" content="
This function is deprecated, please use derive_var_joined_exist_flag() instead."><meta property="og:image" content="https://pharmaverse.github.io/admiral/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/admiral.html">Get Started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-user-guides">User Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-user-guides">
    <a class="dropdown-item" href="../articles/admiral.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Deep Dives on ADaMs</h6>
    <a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a>
    <a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a>
    <a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a>
    <a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a>
    <a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a>
    <a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a>
    <h6 class="dropdown-header" data-toc-skip>Advanced User Guides</h6>
    <a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a>
    <a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a>
    <a class="dropdown-item" href="../articles/generic.html">Generic Functions</a>
    <a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a>
    <a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a>
    <a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a>
    <a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-community">Community</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-community">
    <a class="dropdown-item" href="../articles/contribution_model.html">Contribute to admiral</a>
    <a class="external-link dropdown-item" href="https://app.slack.com/client/T028PB489D3/C02M8KN8269">Find us on Slack</a>
    <a class="external-link dropdown-item" href="https://pharmaverse.org/">Welcome to the Pharmaverse</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Derive Confirmation Flag</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/R/derive_var_joined_exist_flag.R" class="external-link"><code>R/derive_var_joined_exist_flag.R</code></a></small>
      <div class="d-none name"><code>derive_var_confirmation_flag.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p>
<p>This function is <em>deprecated</em>, please use <code><a href="derive_var_joined_exist_flag.html">derive_var_joined_exist_flag()</a></code> instead.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_var_confirmation_flag</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">by_vars</span>,</span>
<span>  <span class="va">order</span>,</span>
<span>  <span class="va">new_var</span>,</span>
<span>  tmp_obs_nr_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">join_vars</span>,</span>
<span>  <span class="va">join_type</span>,</span>
<span>  first_cond <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">filter</span>,</span>
<span>  true_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  false_value <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  check_type <span class="op">=</span> <span class="st">"warning"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dataset</dt>
<dd><p>Input dataset</p>
<p>The variables specified by the <code>by_vars</code> and <code>join_vars</code> parameter are
expected.</p></dd>


<dt>by_vars</dt>
<dd><p>By variables</p>
<p>The specified variables are used as by variables for joining the input
dataset with itself.</p></dd>


<dt>order</dt>
<dd><p>Order</p>
<p>The observations are ordered by the specified order.</p></dd>


<dt>new_var</dt>
<dd><p>New variable</p>
<p>The specified variable is added to the input dataset.</p></dd>


<dt>tmp_obs_nr_var</dt>
<dd><p>Temporary observation number</p>
<p>The specified variable is added to the input dataset and set to the
observation number with respect to <code>order</code>. For each by group (<code>by_vars</code>)
the observation number starts with <code>1</code>. The variable can be used in the
conditions (<code>filter</code>, <code>first_cond</code>). It is not included in the output
dataset. It can be used to flag consecutive observations or the last
observation (see last example below).</p></dd>


<dt>join_vars</dt>
<dd><p>Variables to keep from joined dataset</p>
<p>The variables needed from the other observations should be specified
for this parameter. The specified variables are added to the joined dataset
with suffix ".join". For example to flag all observations with <code>AVALC == "Y"</code> and <code>AVALC == "Y"</code> for at least one subsequent visit <code>join_vars = exprs(AVALC, AVISITN)</code> and <code>filter = AVALC == "Y" &amp; AVALC.join == "Y" &amp; AVISITN &lt; AVISITN.join</code> could be specified.</p>
<p>The <code>*.join</code> variables are not included in the output dataset.</p></dd>


<dt>join_type</dt>
<dd><p>Observations to keep after joining</p>
<p>The argument determines which of the joined observations are kept with
respect to the original observation. For example, if <code>join_type = "after"</code>
is specified all observations after the original observations are kept.</p>
<p>For example for confirmed response or BOR in the oncology setting or
confirmed deterioration in questionnaires the confirmatory assessment must
be after the assessment to be flagged. Thus <code>join_type = "after"</code> could be
used.</p>
<p>Whereas, sometimes you might allow for confirmatory observations to occur
prior to the observation to be flagged. For example, to flag AEs occurring
on or after seven days before a COVID AE. Thus <code>join_type = "all"</code> could be
used.</p>
<p><em>Permitted Values:</em> <code>"before"</code>, <code>"after"</code>, <code>"all"</code></p></dd>


<dt>first_cond</dt>
<dd><p>Condition for selecting range of data</p>
<p>If this argument is specified, the other observations are restricted up to
the first observation where the specified condition is fulfilled. If the
condition is not fulfilled for any of the other observations, no
observations are considered, i.e., the observation is not flagged.</p>
<p>This parameter should be specified if <code>filter</code> contains summary functions
which should not apply to all observations but only up to the confirmation
assessment. For an example see the third example below.</p></dd>


<dt>filter</dt>
<dd><p>Condition for selecting observations</p>
<p>The filter is applied to the joined dataset for flagging the confirmed
observations. The condition can include summary functions. The joined
dataset is grouped by the original observations. I.e., the summary function
are applied to all observations up to the confirmation observation. For
example, <code>filter = AVALC == "CR" &amp; all(AVALC.join %in% c("CR", "NE")) &amp; count_vals(var = AVALC.join, val = "NE") &lt;= 1</code> selects observations with
response "CR" and for all observations up to the confirmation observation
the response is "CR" or "NE" and there is at most one "NE".</p></dd>


<dt>true_value</dt>
<dd><p>Value of <code>new_var</code> for flagged observations</p>
<p><em>Default</em>: <code>"Y"</code></p></dd>


<dt>false_value</dt>
<dd><p>Value of <code>new_var</code> for observations not flagged</p>
<p><em>Default</em>: <code>NA_character_</code></p></dd>


<dt>check_type</dt>
<dd><p>Check uniqueness?</p>
<p>If <code>"warning"</code> or <code>"error"</code> is specified, the specified message is issued
if the observations of the input dataset are not unique with respect to the
by variables and the order.</p>
<p><em>Default:</em> <code>"warning"</code></p>
<p><em>Permitted Values:</em> <code>"none"</code>, <code>"warning"</code>, <code>"error"</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The input dataset with the variable specified by <code>new_var</code> added.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The following steps are performed to produce the output dataset.</p><div class="section">
<h3 id="step-">Step 1<a class="anchor" aria-label="anchor" href="#step-"></a></h3>


<p>The input dataset is joined with itself by the variables specified for
<code>by_vars</code>. From the right hand side of the join only the variables
specified for <code>join_vars</code> are kept. The suffix ".join" is added to these
variables.</p>
<p>For example, for <code>by_vars = USUBJID</code>, <code>join_vars = exprs(AVISITN, AVALC)</code> and input dataset</p>
<p></p><div class="sourceCode r"><pre><code># A tibble: 2 x 4
USUBJID AVISITN AVALC  AVAL
&lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1             1 Y         1
1             2 N         0
</code></pre><p></p></div>
<p>the joined dataset is</p>
<p></p><div class="sourceCode r"><pre><code>A tibble: 4 x 6
USUBJID AVISITN AVALC  AVAL AVISITN.join AVALC.join
&lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;
1             1 Y         1            1 Y
1             1 Y         1            2 N
1             2 N         0            1 Y
1             2 N         0            2 N
</code></pre><p></p></div>
</div>

<div class="section">
<h3 id="step--1">Step 2<a class="anchor" aria-label="anchor" href="#step--1"></a></h3>


<p>The joined dataset is restricted to observations with respect to
<code>join_type</code> and <code>order</code>.</p>
<p>The dataset from the example in the previous step with <code>join_type = "after"</code> and <code>order = exprs(AVISITN)</code> is restricted to</p>
<p></p><div class="sourceCode r"><pre><code>A tibble: 4 x 6
USUBJID AVISITN AVALC  AVAL AVISITN.join AVALC.join
&lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;
1             1 Y         1            2 N
</code></pre><p></p></div>
</div>

<div class="section">
<h3 id="step--2">Step 3<a class="anchor" aria-label="anchor" href="#step--2"></a></h3>


<p>If <code>first_cond</code> is specified, for each observation of the input dataset the
joined dataset is restricted to observations up to the first observation
where <code>first_cond</code> is fulfilled (the observation fulfilling the condition
is included). If for an observation of the input dataset the condition is
not fulfilled, the observation is removed.</p>
</div>

<div class="section">
<h3 id="step--3">Step 4<a class="anchor" aria-label="anchor" href="#step--3"></a></h3>


<p>The joined dataset is grouped by the observations from the input dataset
and restricted to the observations fulfilling the condition specified by
<code>filter</code>.</p>
</div>

<div class="section">
<h3 id="step--4">Step 5<a class="anchor" aria-label="anchor" href="#step--4"></a></h3>


<p>The first observation of each group is selected</p>
</div>

<div class="section">
<h3 id="step--5">Step 6<a class="anchor" aria-label="anchor" href="#step--5"></a></h3>


<p>The variable specified by <code>new_var</code> is added to the input dataset. It is
set to <code>true_value</code> for all observations which were selected in the
previous step. For the other observations it is set to <code>false_value</code>.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other deprecated: 
<code><a href="derive_param_extreme_event.html">derive_param_extreme_event</a>()</code>,
<code><a href="derive_var_basetype.html">derive_var_basetype</a>()</code>,
<code><a href="derive_var_last_dose_amt.html">derive_var_last_dose_amt</a>()</code>,
<code><a href="derive_var_last_dose_date.html">derive_var_last_dose_date</a>()</code>,
<code><a href="derive_var_last_dose_grp.html">derive_var_last_dose_grp</a>()</code>,
<code><a href="derive_var_merged_cat.html">derive_var_merged_cat</a>()</code>,
<code><a href="derive_var_merged_character.html">derive_var_merged_character</a>()</code>,
<code><a href="derive_vars_last_dose.html">derive_vars_last_dose</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ben Straub, Stefan Bundfuss, Jeffrey Dickinson, Ross Farrugia, Adam Forys, Daphne Grasselly, Dinakar Kulkarni, Edoardo Mancini, Sadchla Mascary, Gordon Miller, Sophie Shapcott, Eric Simms, Stefan Thoma, Kangjie Zhang, Zelos Zhu, G Gayatri, Thomas Neitmann, F. Hoffmann-La Roche AG, GlaxoSmithKline LLC.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

